<div class="timeline">
  <div class="timeline-header">
    <h2>Goals Timeline</h2>
    <div class="dropdown">
      <a class="btn" [class.disabled]="!(filteredGoals().length > 0)" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="bi bi-download download-icon"></i>
      </a>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        <a class="dropdown-item" href="#" (click)="downloadGoals('png')">png</a>
        <a class="dropdown-item" href="#" (click)="downloadGoals('pdf')">pdf</a>
      </div>
    </div>
  </div>

  <div class="timeline-parent" cdkDropListGroup>
    <div class="timeline-user-info">
    </div>
    <div class="timeline__Wrapper">
      @if(activeGoals().length > 0 || archievedGoals().length > 0 ){
      <div class="active-container goal">
        <h2>Active</h2>
        <div cdkDropList cdkDropListOrientation="mixed" [cdkDropListData]="activeGoals()" (cdkDropListDropped)="drop($event)"
          class="timeline-container">

          @for (goal of activeGoals(); track $index) {
          <div cdkDrag [cdkDragData]="goal" class="goal">
            <div class="card timeline-box">
              <div class="card-body">
                <h3 class="card-title">{{ goal.goalTitle }}</h3>
                <p class="card-text">{{ goal.goalText }}</p>
                <span class="timeline-date">{{ goal.goalMonth }}</span>
                <span class="state-badge" [class.archived]="goal.goalState === 'archived'">
                  {{ goal.goalState }}
                </span>
              </div>
            </div>
          </div>
          }
        </div>
      </div>

      <div class="archieved-container goal">
        <h2>Archived</h2>
        <div cdkDropList cdkDropListOrientation="mixed" [cdkDropListData]="archievedGoals()" (cdkDropListDropped)="drop($event)"
          class="timeline-container">
          @for (goal of archievedGoals(); track $index) {
          <div cdkDrag [cdkDragData]="goal">
            <div class="card timeline-box">
              <div class="card-body">
                <h3 class="card-title">{{ goal.goalTitle }}</h3>
                <p class="card-text">{{ goal.goalText }}</p>
                <span class="timeline-date">{{ goal.goalMonth }}</span>
                <span class="state-badge" [class.archived]="goal.goalState === 'archived'">
                  {{ goal.goalState }}
                </span>
              </div>
            </div>
          </div>
          }
        </div>

      </div>
      }
      @else {
      <div class="no-goals">
        <p>No goals added yet. Please add your first goal!</p>
      </div>
      }
    </div>


  </div>
</div>